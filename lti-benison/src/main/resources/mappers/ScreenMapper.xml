<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.liketry.interaction.benison.dao.ScreenMapper">
    <resultMap id="BaseResultMap" type="com.liketry.interaction.benison.model.Screen">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        <id column="screen_id" jdbcType="VARCHAR" property="screenId"/>
        <result column="spot_id" jdbcType="VARCHAR" property="spotId"/>
        <result column="screen_code" jdbcType="VARCHAR" property="screenCode"/>
        <result column="screen_name" jdbcType="VARCHAR" property="screenName"/>
        <result column="screen_status" jdbcType="CHAR" property="screenStatus"/>
        <result column="screen_img" jdbcType="VARCHAR" property="screenImg"/>
        <result column="screen_location" jdbcType="VARCHAR" property="screenLocation"/>
        <result column="screen_longitude" jdbcType="VARCHAR" property="screenLongitude"/>
        <result column="screen_dimension" jdbcType="VARCHAR" property="screenDimension"/>
        <result column="screen_long" jdbcType="VARCHAR" property="screenLong"/>
        <result column="screen_wide" jdbcType="VARCHAR" property="screenWide"/>
        <result column="screen_size" jdbcType="VARCHAR" property="screenSize"/>
        <result column="screen_resolution" jdbcType="VARCHAR" property="screenResolution"/>
        <result column="screen_description" jdbcType="VARCHAR" property="screenDescription"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        screen_id, spot_id, screen_code, screen_name, screen_status, screen_img, screen_location,
        screen_longitude, screen_dimension, screen_long, screen_wide, screen_size, screen_resolution,
        screen_description
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        select
        <include refid="Base_Column_List"/>
        from bu_screen
        where screen_id = #{screenId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        delete from bu_screen
        where screen_id = #{screenId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.liketry.interaction.benison.model.Screen">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        insert into bu_screen (screen_id, spot_id, screen_code,
        screen_name, screen_status, screen_img,
        screen_location, screen_longitude, screen_dimension,
        screen_long, screen_wide, screen_size,
        screen_resolution, screen_description)
        values (#{screenId,jdbcType=VARCHAR}, #{spotId,jdbcType=VARCHAR}, #{screenCode,jdbcType=VARCHAR},
        #{screenName,jdbcType=VARCHAR}, #{screenStatus,jdbcType=CHAR}, #{screenImg,jdbcType=VARCHAR},
        #{screenLocation,jdbcType=VARCHAR}, #{screenLongitude,jdbcType=VARCHAR}, #{screenDimension,jdbcType=VARCHAR},
        #{screenLong,jdbcType=VARCHAR}, #{screenWide,jdbcType=VARCHAR}, #{screenSize,jdbcType=VARCHAR},
        #{screenResolution,jdbcType=VARCHAR}, #{screenDescription,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.liketry.interaction.benison.model.Screen">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        insert into bu_screen
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="screenId != null">
                screen_id,
            </if>
            <if test="spotId != null">
                spot_id,
            </if>
            <if test="screenCode != null">
                screen_code,
            </if>
            <if test="screenName != null">
                screen_name,
            </if>
            <if test="screenStatus != null">
                screen_status,
            </if>
            <if test="screenImg != null">
                screen_img,
            </if>
            <if test="screenLocation != null">
                screen_location,
            </if>
            <if test="screenLongitude != null">
                screen_longitude,
            </if>
            <if test="screenDimension != null">
                screen_dimension,
            </if>
            <if test="screenLong != null">
                screen_long,
            </if>
            <if test="screenWide != null">
                screen_wide,
            </if>
            <if test="screenSize != null">
                screen_size,
            </if>
            <if test="screenResolution != null">
                screen_resolution,
            </if>
            <if test="screenDescription != null">
                screen_description,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="screenId != null">
                #{screenId,jdbcType=VARCHAR},
            </if>
            <if test="spotId != null">
                #{spotId,jdbcType=VARCHAR},
            </if>
            <if test="screenCode != null">
                #{screenCode,jdbcType=VARCHAR},
            </if>
            <if test="screenName != null">
                #{screenName,jdbcType=VARCHAR},
            </if>
            <if test="screenStatus != null">
                #{screenStatus,jdbcType=CHAR},
            </if>
            <if test="screenImg != null">
                #{screenImg,jdbcType=VARCHAR},
            </if>
            <if test="screenLocation != null">
                #{screenLocation,jdbcType=VARCHAR},
            </if>
            <if test="screenLongitude != null">
                #{screenLongitude,jdbcType=VARCHAR},
            </if>
            <if test="screenDimension != null">
                #{screenDimension,jdbcType=VARCHAR},
            </if>
            <if test="screenLong != null">
                #{screenLong,jdbcType=VARCHAR},
            </if>
            <if test="screenWide != null">
                #{screenWide,jdbcType=VARCHAR},
            </if>
            <if test="screenSize != null">
                #{screenSize,jdbcType=VARCHAR},
            </if>
            <if test="screenResolution != null">
                #{screenResolution,jdbcType=VARCHAR},
            </if>
            <if test="screenDescription != null">
                #{screenDescription,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.liketry.interaction.benison.model.Screen">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        update bu_screen
        <set>
            <if test="spotId != null">
                spot_id = #{spotId,jdbcType=VARCHAR},
            </if>
            <if test="screenCode != null">
                screen_code = #{screenCode,jdbcType=VARCHAR},
            </if>
            <if test="screenName != null">
                screen_name = #{screenName,jdbcType=VARCHAR},
            </if>
            <if test="screenStatus != null">
                screen_status = #{screenStatus,jdbcType=CHAR},
            </if>
            <if test="screenImg != null">
                screen_img = #{screenImg,jdbcType=VARCHAR},
            </if>
            <if test="screenLocation != null">
                screen_location = #{screenLocation,jdbcType=VARCHAR},
            </if>
            <if test="screenLongitude != null">
                screen_longitude = #{screenLongitude,jdbcType=VARCHAR},
            </if>
            <if test="screenDimension != null">
                screen_dimension = #{screenDimension,jdbcType=VARCHAR},
            </if>
            <if test="screenLong != null">
                screen_long = #{screenLong,jdbcType=VARCHAR},
            </if>
            <if test="screenWide != null">
                screen_wide = #{screenWide,jdbcType=VARCHAR},
            </if>
            <if test="screenSize != null">
                screen_size = #{screenSize,jdbcType=VARCHAR},
            </if>
            <if test="screenResolution != null">
                screen_resolution = #{screenResolution,jdbcType=VARCHAR},
            </if>
            <if test="screenDescription != null">
                screen_description = #{screenDescription,jdbcType=VARCHAR},
            </if>
        </set>
        where screen_id = #{screenId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.liketry.interaction.benison.model.Screen">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Jul 10 14:00:47 CST 2017.
        -->
        update bu_screen
        set spot_id = #{spotId,jdbcType=VARCHAR},
        screen_code = #{screenCode,jdbcType=VARCHAR},
        screen_name = #{screenName,jdbcType=VARCHAR},
        screen_status = #{screenStatus,jdbcType=CHAR},
        screen_img = #{screenImg,jdbcType=VARCHAR},
        screen_location = #{screenLocation,jdbcType=VARCHAR},
        screen_longitude = #{screenLongitude,jdbcType=VARCHAR},
        screen_dimension = #{screenDimension,jdbcType=VARCHAR},
        screen_long = #{screenLong,jdbcType=VARCHAR},
        screen_wide = #{screenWide,jdbcType=VARCHAR},
        screen_size = #{screenSize,jdbcType=VARCHAR},
        screen_resolution = #{screenResolution,jdbcType=VARCHAR},
        screen_description = #{screenDescription,jdbcType=VARCHAR}
        where screen_id = #{screenId,jdbcType=VARCHAR}
    </update>

    <select id="selectAll" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT
        bu_screen.spot_id spotId,spot_name spotName,screen_id screenId, screen_code screenCode, screen_name screenName, screen_status screenStatus, screen_location screenLocation, screen_longitude
        screenLongitude,
        screen_dimension screenDimension, screen_long screenLong, screen_wide screenWide, screen_size screenSize, screen_resolution screenResolution, screen_description screenDescription
        FROM bu_screen left join bu_spot on bu_screen.spot_id = bu_spot.spot_id WHERE 1 = 1
        <if test="_parameter != null and _parameter != ''">
            AND screen_status = #{screenStatus,jdbcType = CHAR}
        </if>
    </select>

    <update id="deleteLogicById" parameterType="java.lang.String">
        UPDATE bu_screen SET screen_status = '-1' WHERE screen_id = #{screenStatus, jdbcType = VARCHAR}
    </update>
    <select id="selectByName" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT * FROM bu_screen WHERE screen_status = 1 and screen_name LIKE CONCAT('%',#{screenName,jdbcType = VARCHAR},'%') ORDER BY screen_code ASC
    </select>

    <select id="selectNormalAll" resultType="java.util.Map">
        SELECT
        bu_screen.spot_id spotId,spot_name spotName,screen_id screenId, screen_code screenCode, screen_name screenName, screen_status screenStatus, screen_location screenLocation, screen_longitude
        screenLongitude,screen_img screenImg,
        screen_dimension screenDimension, screen_long screenLong, screen_wide screenWide, screen_size screenSize, screen_resolution screenResolution, screen_description screenDescription
        FROM bu_screen left join bu_spot on bu_screen.spot_id = bu_spot.spot_id WHERE screen_status = '1'
    </select>

    <select id="selectScreen" parameterType="String" resultMap="BaseResultMap">
        select s.* from bu_screen s left join bu_benison_template bt 
        	on s.screen_id = bt.screen_id where bt.template_id = #{templateId,jdbcType = VARCHAR};
    </select>

    <select id="selectHotScreenId" parameterType="int" resultType="String">
        SELECT bu_screen.screen_id, count(bu_screen.screen_id) size
        FROM bu_order_detail,bu_commodity,bu_screen where bu_order_detail.commodity_id = bu_commodity.commodity_id and bu_commodity.screen_id = bu_screen.screen_id and screen_status = '1'
        group by bu_screen.screen_id  order by size desc limit #{screenSize}
    </select>

    <select id="findExtraScreenId" resultType="String">
        SELECT * FROM bu_screen
        where screen_status = '1'
        <foreach close=")" collection="extras" index="index" item="item" open=" and screen_id not in (" separator=",">
            #{item}
        </foreach>
        limit #{screenSize};
    </select>

    <resultMap id="ScreenVoMap" type="com.liketry.interaction.benison.vo.api.ScreenVo">
        <id column="screen_id" jdbcType="VARCHAR" property="screenId"/>
        <result column="spot_id" jdbcType="VARCHAR" property="spotId"/>
        <result column="screen_code" jdbcType="VARCHAR" property="screenCode"/>
        <result column="screen_name" jdbcType="VARCHAR" property="screenName"/>
        <result column="screen_status" jdbcType="CHAR" property="screenStatus"/>
        <result column="screen_img" jdbcType="VARCHAR" property="screenImg"/>
        <result column="screen_location" jdbcType="VARCHAR" property="screenLocation"/>
        <result column="screen_longitude" jdbcType="VARCHAR" property="screenLongitude"/>
        <result column="screen_dimension" jdbcType="VARCHAR" property="screenDimension"/>
        <result column="screen_long" jdbcType="VARCHAR" property="screenLong"/>
        <result column="screen_wide" jdbcType="VARCHAR" property="screenWide"/>
        <result column="screen_size" jdbcType="VARCHAR" property="screenSize"/>
        <result column="screen_resolution" jdbcType="VARCHAR" property="screenResolution"/>
        <result column="screen_description" jdbcType="VARCHAR" property="screenDescription"/>
    </resultMap>

    <select id="aroundScreen" parameterType="double" resultMap="ScreenVoMap">
      SELECT * FROM bu_screen
      WHERE screen_longitude != 0 AND screen_dimension != 0 AND screen_status = '1'
      AND screen_longitude &gt;= #{leftLongitude}
      AND screen_longitude &lt;= #{rightLongitude}
      AND screen_dimension &gt;= #{topLatitude}
      AND screen_dimension &lt;= #{bottomLatitude}
    </select>
    <select id="findByScreenId" resultType="java.lang.String">
        SELECT spot_id FROM bu_screen where screen_id = #{screenId}
    </select>
</mapper>